---
title: 你不知道的模块加载机制
description: 模块加载机制
published: 1
date: 2022-04-10T09:55:46.588Z
tags: module
editor: markdown
dateCreated: 2022-04-10T09:55:46.588Z
---

# 模块的加载机制
>  优先从缓存中加载
{.is-info}

模块第一次加载后会被缓存，之后引入相同的模块，其中的代码都不会被重复执行。模块的缓存机制适用于自定义模块、第三方模块、内置模块，作用是提高模块的加载效率
>  内置模块的加载机制
{.is-info}

内置模块的加载机制优先级最高，例如fs模块。
> 自定义模块加载机制
{.is-info}

+ 以相对路径开头的表示加载的是自定义模块
+ require自定义模块时，如果省略了文件拓展名则将按以下顺序加载文件：
1. 按照确切的文件名进行加载
2. 补全.js拓展名进行加载
3. 补全.json拓展名进行加载
4. 补全.node拓展名进行加载
> 第三方模块加载机制
{.is-info}

+ 如果require模块的标识符不是内置模块也不是相对路径开头则加载第三方模块
+ 其查找模块的方式是从当前引入模块的父目录查找/node_modules中加载第三方模块如果没有继续从上一层目录中的/node_modules中加载第三发模块，以此类推。
> 目录作为模块加载机制
{.is-info}

把目录作为标识符传递给require进行加载有三种加载方式：
1. 从被加载的目录寻找package.json配置文件，并查找main属性作为require的加载入口
2. 没有package.json文件或者main入口不存在或者无法解析则node.js会加载目录下的index.js文件
3. 以上都失败则报错：Cannot find module 'xxx'